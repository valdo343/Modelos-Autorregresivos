<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>4&nbsp; Ajuste del modelo a una serie de tiempo – Modelos Autoregresivos</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../Caps/05-Caso de estudio.html" rel="next">
<link href="../Caps/03-Modelos lineales para series de tiempo estacionarias.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-8da5b4427184b79ecddefad3d342027e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../Caps/04-Ajuste del modelo a una serie de tiempo.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Ajuste del modelo a una serie de tiempo</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Buscar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Modelos Autoregresivos</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Presentación</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Caps/01-Introduccion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introducción</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Caps/02-Series de Tiempo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Series de Tiempo</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Caps/03-Modelos lineales para series de tiempo estacionarias.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Modelos lineales para series de tiempo estacionarias</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Caps/04-Ajuste del modelo a una serie de tiempo.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Ajuste del modelo a una serie de tiempo</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Caps/05-Caso de estudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Casos de Estudios</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Referencias</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#identificación-del-modelo" id="toc-identificación-del-modelo" class="nav-link active" data-scroll-target="#identificación-del-modelo"><span class="header-section-number">4.1</span> Identificación del Modelo</a></li>
  <li><a href="#estimación-de-parámetros" id="toc-estimación-de-parámetros" class="nav-link" data-scroll-target="#estimación-de-parámetros"><span class="header-section-number">4.2</span> Estimación de parámetros</a></li>
  <li><a href="#verificación-de-diagnóstico" id="toc-verificación-de-diagnóstico" class="nav-link" data-scroll-target="#verificación-de-diagnóstico"><span class="header-section-number">4.3</span> Verificación de Diagnóstico</a></li>
  <li><a href="#pronósticos-de-un-proceso-arima" id="toc-pronósticos-de-un-proceso-arima" class="nav-link" data-scroll-target="#pronósticos-de-un-proceso-arima"><span class="header-section-number">4.4</span> Pronósticos de un proceso ARIMA</a></li>
  <li><a href="#ejemplos-de-ajuste-de-datos" id="toc-ejemplos-de-ajuste-de-datos" class="nav-link" data-scroll-target="#ejemplos-de-ajuste-de-datos"><span class="header-section-number">4.5</span> Ejemplos de ajuste de datos</a>
  <ul class="collapse">
  <li><a href="#ventas-de-productos-farmacéuticos" id="toc-ventas-de-productos-farmacéuticos" class="nav-link" data-scroll-target="#ventas-de-productos-farmacéuticos"><span class="header-section-number">4.5.1</span> Ventas de productos farmacéuticos</a></li>
  <li><a href="#producción-de-queso-y-gorgonzola-en-eua" id="toc-producción-de-queso-y-gorgonzola-en-eua" class="nav-link" data-scroll-target="#producción-de-queso-y-gorgonzola-en-eua"><span class="header-section-number">4.5.2</span> Producción de Queso y Gorgonzola en EUA</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Ajuste del modelo a una serie de tiempo</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Se utiliza un procedimiento iterativo de tres pasos para construir un modelo ARIMA.</p>
<ol type="1">
<li><p>Se identifica un modelo tentativo de la clase ARIMA mediante el análisis de datos históricos.</p></li>
<li><p>Se estiman los parámetros desconocidos del modelo.</p></li>
<li><p>Se realizan comprobaciones diagnósticas para determinar la adecuación del modelo o para indicar posibles mejoras través del análisis de residuos.</p></li>
</ol>
<section id="identificación-del-modelo" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="identificación-del-modelo"><span class="header-section-number">4.1</span> Identificación del Modelo</h2>
<p>Los esfuerzos de identificación del modelo deben comenzar con intentos preliminares de comprender el tipo de proceso del que provienen los datos y cómo se recolectan. Las características percibidas del proceso y la frecuencia de muestreo a menudo proporcionan información valiosa en esta etapa preliminar de la identificación del modelo. En los entornos actuales, ricos en datos, a menudo se espera que los profesionales dispongan de “suficientes” datos para poder generar modelos confiables.</p>
<p>Antes de llevar a cabo esfuerzos rigurosos de construcción de modelos estadísticos, también se recomienda encarecidamente el uso de gráficos “creativos” de los datos, como el simple gráfico de series temporales y los diagramas de dispersión de los datos de series temporales <span class="math inline">\(Y_t\)</span> frente a <span class="math inline">\(Y_{t-1}, Y_{t-2},...\)</span>. Los gráficos simples de series de tiempo deben usarse como herramienta de evaluación preliminar para la estacionariedad. La inspección visual de estos gráficos debería confirmarse más adelante como se describió anteriormente en este capítulo. Si se sospecha de no estacionariedad, también debe considerarse el gráfico de series temporales de la primera (o <span class="math inline">\(d\)</span>-ésima) diferencia. También se puede realizar la prueba de Dickey y Fuller para asegurarse de que efectivamente se necesita la diferenciación. Una vez que se puede asumir la estacionariedad, se deben obtener la ACF y PACF de la serie temporal original (o de su <span class="math inline">\(d\)</span>-ésima diferencia si es necesario).</p>
<p>La identificación de modelos ARMA requeriría más cuidado, ya que tanto la ACF como la PACF mostrarán una decaimiento exponencial y/o comportamiento sinusoidal amortiguado. La identificación del modelo ARIMA apropiado requiere habilidades adquiridas por experiencia.</p>
</section>
<section id="estimación-de-parámetros" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="estimación-de-parámetros"><span class="header-section-number">4.2</span> Estimación de parámetros</h2>
<p>Existen varios métodos, como los métodos de momentos, máxima verosimilitud y mínimos cuadrados, que pueden emplearse para estimar los parámetros en el modelo identificado tentativamente. Sin embargo, a diferencia de los modelos de regresión, la mayoría de los modelos ARIMA son modelos no lineales y requieren el uso de un procedimiento de ajuste no lineal. No obstante, esto generalmente se realiza de manera automática mediante paquetes de software sofisticados como Minitab, JMP y SAS. En algunos paquetes de software, el usuario puede tener la opción de elegir el método de estimación y, en consecuencia, seleccionar el método más apropiado según las especificaciones del problema.</p>
</section>
<section id="verificación-de-diagnóstico" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="verificación-de-diagnóstico"><span class="header-section-number">4.3</span> Verificación de Diagnóstico</h2>
<p>Después de ajustar un modelo tentativo a los datos, se debe de examinar su adecuación y, si es necesario, sugerir posibles mejoras. Esto se hace mediante el análisis de residuos. Los residuos para un proceso ARMA (<span class="math inline">\(p,q\)</span>) pueden obtenerse mediante: <span class="math display">\[ \hat{\varepsilon}_t=Y_t-\left(\hat{\delta}+\sum_{i=1}^p\hat{\phi}_iY_{t-i}-\sum_{i=1}^q\hat{\theta}_i\hat{\varepsilon}_{t-i}\right)\]</span> Si el modelo especificado es adecuado y, por lo tanto, se han identificado los órdenes apropiados <span class="math inline">\(p\)</span> y <span class="math inline">\(q\)</span> debería transformar las observaciones en un proceso de ruido blanco. Así, los residuos en la ecuación anterior deberían comportarse como ruido blanco.</p>
<p>Denotemos la función de autocorrelación muestral de los residuos como <span class="math inline">\(\{r_e(k)\}\)</span>. Si el modelo es apropiado, entonces la función de autocorrelación muestral de los residuos no debería presentar estructura alguna para identificar. Es decir, la autocorrelación no debería diferir significativamente de cero para todos los rezagos mayores que uno.</p>
</section>
<section id="pronósticos-de-un-proceso-arima" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="pronósticos-de-un-proceso-arima"><span class="header-section-number">4.4</span> Pronósticos de un proceso ARIMA</h2>
<p>Una vez que se ha ajustado un modelo de series de tiempo apropiado, puede utilizarse para generar pronósticos de observaciones futuras. Si denotamos el tiempo actual como <span class="math inline">\(T\)</span>, el pronóstico para <span class="math inline">\(Y_{T+\tau}\)</span> se llama pronóstico a <span class="math inline">\(\tau-\)</span>pasos pasos adelante y se denota como <span class="math inline">\(\hat{Y}_{T+\tau}(T)\)</span> El criterio estándar utilizado para obtener el mejor pronóstico es el error cuadrático medio, para el cual se minimiza el valor esperado del cuadrado de los errores de pronóstico: <span class="math display">\[ \mathbb{E}[(Y_{T+\tau}-\hat{Y}_{T+\tau}(T))^2]=\mathbb{E}[e_T(\tau)^2].\]</span> Se puede demostrar que el mejor pronóstico en el sentido de error cuadrático medio es la esperanza condicional de <span class="math inline">\(Y_{T+\tau}\)</span> dado <span class="math inline">\(Y_{T},Y-{T-1},...,\)</span> es decir: <span class="math display">\[ \hat{Y}_{T+\tau}=\mathbb{E}[Y_{T+\tau}|Y_T,Y_{T-1},...].\]</span> Consideremos, por ejemplo, un proceso ARIMA(<span class="math inline">\(p,d,q\)</span>) en el tiempo <span class="math inline">\(T+\tau\)</span>. Consideremos además su representación MA infinita: <span class="math display">\[ Y_{T+\tau}=\mu+\sum_{i=1}^\infty \psi_i\varepsilon_{T+\tau-i}. \]</span> Podemos particionar la ecuación anterior como <span class="math display">\[Y_{T+\tau}=\mu+\sum_{i=1}^{\tau-1} \psi_i\varepsilon_{T+\tau-i}+\sum_{i=\tau}^\infty \psi_i\varepsilon_{T+\tau-i}.\]</span></p>
<p>En esta partición, podemos ver que el componente <span class="math inline">\(\sum_{i=1}^{\tau-1} \psi_i\varepsilon_{T+\tau-i}\)</span> involucra errores futuros, mientras que el componente <span class="math inline">\(\sum_{i=\tau}^\infty \psi_i\varepsilon_{T+\tau-i}\)</span> involucra errores presentes y pasados. A partir de la relación entre las observaciones actuales y pasadas y los choques aleatorios correspondientes, así como el hecho de que se asume que los choques aleatorios tienen media cero y son independientes, se puede demostrar que el mejor pronóstico en el sentido de error cuadrático medio es: <span class="math display">\[ \hat{Y}_{T+\tau}=\mathbb{E}[Y_{T+\tau}|Y_T,Y_{T-1},...]=\mu+ \sum_{i=\tau}^\infty \psi_i\varepsilon_{T+\tau-i},\]</span> dado que: <span class="math display">\[ \mathbb{E}[\varepsilon_{T+\tau-i}|Y_T,Y_{T-1},...]=\begin{cases} 0 &amp; \text{si } i &lt; \tau \\ \varepsilon_{T+\tau-i} &amp; \text{si } i\geq\tau \end{cases}. \]</span> Posteriormente, el error de pronóstico se calcula a partir de: <span class="math display">\[e_T(\tau)=Y_{T\tau}-\hat{Y}_{T+\tau}(T)=\sum_{i=0}^{\tau-1}\psi_i\varepsilon_{T+\tau-i}. \]</span></p>
<p>Dado que el error de pronóstico es una combinación lineal de choques aleatorios, tenemos: <span class="math display">\[\mathbb{E}=(e_T(\tau))=0 \\ Var(e_T(\tau))=\sum_{i=0}^{\tau-1}\psi^2_iVar(\varepsilon_{T+\tau-i})=\sigma^2\sum_{i=0}^{\tau-1}\psi^2=\sigma^2(\tau), \ \ \ \tau=1,2,... .\]</span> Debe observarse que la varianza del error de pronóstico aumenta con el tiempo de adelanto <span class="math inline">\(\tau\)</span>. Esto tiene sentido intuitivamente, ya que deberíamos esperar más incertidumbre en nuestros pronósticos cuanto más nos alejamos en el futuro. Además, si los choques aleatorios están normalmente distribuidos <span class="math inline">\(N(0,\sigma^2)\)</span> entonces los errores de pronóstico también estarán distribuidos normalmente como <span class="math inline">\(N(0,\sigma^2(\tau))\)</span>. Podemos entonces obtener los intervalos de predicción al <span class="math inline">\(100(1-\alpha)\%\)</span> para las observaciones futuras a partir de: <span class="math display">\[ \mathbb{P}[\hat{Y}_{T+\tau}(T)-z_{\alpha/2}\sigma(\tau)&lt;Y_{T+\tau}&lt;\hat{Y}_{T+\tau}(T)+z_{\alpha/2}\sigma(\tau)]=1-\alpha,\]</span> donde <span class="math inline">\(z_{\alpha/2}\)</span> es el percentil superior <span class="math inline">\(\alpha/2\)</span> de la distribución normal estándar. Por lo tanto el intervalo de predicción al <span class="math inline">\(100(1-\alpha)\%\)</span> para <span class="math inline">\(Y_{T+\tau}\)</span> es <span class="math display">\[ \hat{Y}_{T+\tau}(T)\pm z_{\alpha/2}\sigma(\tau).\]</span></p>
</section>
<section id="ejemplos-de-ajuste-de-datos" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="ejemplos-de-ajuste-de-datos"><span class="header-section-number">4.5</span> Ejemplos de ajuste de datos</h2>
<section id="ventas-de-productos-farmacéuticos" class="level3" data-number="4.5.1">
<h3 data-number="4.5.1" class="anchored" data-anchor-id="ventas-de-productos-farmacéuticos"><span class="header-section-number">4.5.1</span> Ventas de productos farmacéuticos</h3>
<p>El conjunto de datos que estudiaremos en esta sección son ventas de productos farmacéuticos en Estados Unidos.</p>
<p>Analizamos la serie de tiempo, así como sus ACF, PACF y su primer diferencia.</p>
<p>En base a lo anterior escogeremos un modelo ARIMA a la serie de tiempo.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>                              <span class="do">### VENTAS DE FARMACEÚTICOS </span><span class="al">###</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="do">### Librerías necesarias </span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nortest) <span class="co"># Anderson-Darling</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast) <span class="co"># Librería necesaria para la función Arima</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tseries) <span class="co"># Prueba Dickey-Fuller para estacionariedad</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>ventas <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fl">10618.1</span>, <span class="fl">10537.9</span>, <span class="fl">10209.3</span>, <span class="fl">10553.0</span>,  <span class="fl">9934.9</span>, <span class="fl">10534.5</span>, <span class="fl">10196.5</span>, <span class="fl">10511.8</span>, <span class="fl">10089.6</span>, <span class="fl">10371.2</span>,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fl">10239.4</span>, <span class="fl">10472.4</span>, <span class="fl">10827.2</span>, <span class="fl">10640.8</span>, <span class="fl">10517.8</span>, <span class="fl">10154.2</span>,  <span class="fl">9969.2</span>, <span class="fl">10260.4</span>, <span class="fl">10737.0</span>, <span class="fl">10430.0</span>,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="fl">10689.0</span>, <span class="fl">10430.4</span>, <span class="fl">10002.4</span>, <span class="fl">10135.7</span>, <span class="fl">10096.2</span>, <span class="fl">10288.7</span>, <span class="fl">10289.1</span>, <span class="fl">10589.9</span>, <span class="fl">10551.9</span>, <span class="fl">10208.3</span>,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fl">10334.5</span>, <span class="fl">10480.1</span>, <span class="fl">10387.6</span>, <span class="fl">10202.6</span>, <span class="fl">10219.3</span>, <span class="fl">10382.7</span>, <span class="fl">10820.5</span>, <span class="fl">10358.7</span>, <span class="fl">10494.6</span>, <span class="fl">10497.6</span>,</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fl">10431.5</span>, <span class="fl">10447.8</span>, <span class="fl">10684.4</span>, <span class="fl">10176.5</span>, <span class="fl">10616.0</span>, <span class="fl">10627.7</span>, <span class="fl">10684.0</span>, <span class="fl">10246.7</span>, <span class="fl">10265.0</span>, <span class="fl">10090.4</span>,</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="fl">9881.1</span>, <span class="fl">10449.7</span>, <span class="fl">10276.3</span>, <span class="fl">10175.2</span>, <span class="fl">10212.5</span>, <span class="fl">10395.5</span>, <span class="fl">10545.9</span>, <span class="fl">10635.7</span>, <span class="fl">10265.2</span>, <span class="fl">10551.6</span>,</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="fl">10538.2</span>, <span class="fl">10286.2</span>, <span class="fl">10171.3</span>, <span class="fl">10393.1</span>, <span class="fl">10162.3</span>, <span class="fl">10164.5</span>, <span class="fl">10327.0</span>, <span class="fl">10365.1</span>, <span class="fl">10755.9</span>, <span class="fl">10463.6</span>,</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fl">10080.5</span>, <span class="fl">10479.6</span>,  <span class="fl">9980.9</span>, <span class="fl">10039.2</span>, <span class="fl">10246.1</span>, <span class="fl">10368.0</span>, <span class="fl">10446.3</span>, <span class="fl">10535.3</span>, <span class="fl">10786.9</span>,  <span class="fl">9975.8</span>,</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="fl">10160.9</span>, <span class="fl">10422.1</span>, <span class="fl">10757.2</span>, <span class="fl">10463.8</span>, <span class="fl">10307.0</span>, <span class="fl">10134.7</span>, <span class="fl">10207.7</span>, <span class="fl">10488.0</span>, <span class="fl">10262.3</span>, <span class="fl">10785.9</span>,</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="fl">10375.4</span>, <span class="fl">10123.4</span>, <span class="fl">10462.7</span>, <span class="fl">10205.5</span>, <span class="fl">10522.7</span>, <span class="fl">10253.2</span>, <span class="fl">10428.7</span>, <span class="fl">10615.8</span>, <span class="fl">10417.3</span>, <span class="fl">10445.4</span>,</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="fl">10690.6</span>, <span class="fl">10271.8</span>, <span class="fl">10524.8</span>,  <span class="fl">9815.0</span>, <span class="fl">10398.5</span>, <span class="fl">10553.1</span>, <span class="fl">10655.8</span>, <span class="fl">10199.1</span>, <span class="fl">10416.6</span>, <span class="fl">10391.3</span>,</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="fl">10210.1</span>, <span class="fl">10352.5</span>, <span class="fl">10423.8</span>, <span class="fl">10519.3</span>, <span class="fl">10596.7</span>, <span class="fl">10650.0</span>, <span class="fl">10741.6</span>, <span class="fl">10246.0</span>, <span class="fl">10354.4</span>, <span class="fl">10155.4</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfica de la serie de tiempo</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>ventas_ts <span class="ot">=</span> <span class="fu">ts</span>(ventas, <span class="at">start =</span> <span class="dv">1</span>, <span class="at">frequency =</span> <span class="dv">1</span>) <span class="co"># Guardamos los datos como una serie de tiempo</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ventas_ts, <span class="at">main =</span> <span class="st">"Ventas"</span>,</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Semana"</span>, <span class="at">ylab =</span> <span class="st">"Ventas (miles)"</span>,</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"#F4B4C9"</span>, <span class="at">lwd =</span> <span class="dv">2</span>) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-Ajuste-del-modelo-a-una-serie-de-tiempo_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(ventas_ts) <span class="co"># Prueba de Dickey-Fuller para estacionariedad.</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  ventas_ts
Dickey-Fuller = -6.2859, Lag order = 4, p-value = 0.01
alternative hypothesis: stationary</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Revisamos ACF y PACF</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(ventas_ts, <span class="at">main =</span> <span class="st">"ACF"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-Ajuste-del-modelo-a-una-serie-de-tiempo_files/figure-html/unnamed-chunk-1-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(ventas_ts, <span class="at">main =</span> <span class="st">"PACF"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-Ajuste-del-modelo-a-una-serie-de-tiempo_files/figure-html/unnamed-chunk-1-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustamos un modelo ARIMA automáticamente.</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>modelo <span class="ot">=</span> <span class="fu">Arima</span>(ventas_ts, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">3</span>)) <span class="co"># Seleccionamos Arima</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#modelo = auto.arima(ventas_ts)</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: ventas_ts 
ARIMA(3,0,3) with non-zero mean 

Coefficients:
         ar1      ar2     ar3      ma1     ma2      ma3        mean
      1.7218  -1.4351  0.5872  -1.6731  1.2966  -0.6235  10373.7762
s.e.  0.4589   0.5842  0.2299   0.4487  0.5242   0.1921      3.5664

sigma^2 = 43441:  log likelihood = -808.7
AIC=1633.4   AICc=1634.7   BIC=1655.7

Training set error measures:
                   ME     RMSE      MAE         MPE     MAPE      MASE
Training set 1.117581 202.2538 169.5169 -0.02774167 1.634562 0.7174565
                    ACF1
Training set -0.02722326</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>residuales <span class="ot">=</span> <span class="fu">as.numeric</span>(modelo<span class="sc">$</span>residuals) <span class="co"># Guardamos residuales.</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>ajustados <span class="ot">=</span> <span class="fu">as.numeric</span>(modelo<span class="sc">$</span>fitted) <span class="co"># Guardamos valores ajustados.</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfica de ajustados vs residuales</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ajustados, residuales, </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Valores ajustados"</span>, </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Residuales"</span>, </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Residuales vs Ajustados"</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">16</span>,  <span class="co"># punto sólido</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"#F4B4C9"</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"#F06292"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-Ajuste-del-modelo-a-una-serie-de-tiempo_files/figure-html/unnamed-chunk-1-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(modelo)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-Ajuste-del-modelo-a-una-serie-de-tiempo_files/figure-html/unnamed-chunk-1-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from ARIMA(3,0,3) with non-zero mean
Q* = 0.87451, df = 4, p-value = 0.9282

Model df: 6.   Total lags used: 10</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ad.test</span>(residuales) <span class="co"># Prueba de normalidad para los residuales</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Anderson-Darling normality test

data:  residuales
A = 0.42528, p-value = 0.3115</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(residuales)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(residuales, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-Ajuste-del-modelo-a-una-serie-de-tiempo_files/figure-html/unnamed-chunk-1-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfica de la serie de tiempo</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ventas_ts, <span class="at">main =</span> <span class="st">"Ventas"</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Semana"</span>, <span class="at">ylab =</span> <span class="st">"Ventas (miles)"</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"#F4B4C9"</span>, <span class="at">lwd =</span> <span class="dv">2</span>) </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">#points(ventas_ts, pch = 16, col = "#F4B4C9") # Graficamos los datos con circulos</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>ajustados_ts <span class="ot">=</span> <span class="fu">ts</span>(ajustados)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Encimamos los valores ajustados.</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(ajustados_ts, <span class="at">col =</span> <span class="st">"#F06292"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co">#points(ajustados, col = "#CE93D8", lwd = 2, pch = 16)</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Añadir leyenda</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Original"</span>, <span class="st">"Ajustado"</span>),</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"#F4B4C9"</span>, <span class="st">"#F06292"</span>), <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-Ajuste-del-modelo-a-una-serie-de-tiempo_files/figure-html/unnamed-chunk-1-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="producción-de-queso-y-gorgonzola-en-eua" class="level3" data-number="4.5.2">
<h3 data-number="4.5.2" class="anchored" data-anchor-id="producción-de-queso-y-gorgonzola-en-eua"><span class="header-section-number">4.5.2</span> Producción de Queso y Gorgonzola en EUA</h3>
<p>Analizamos un conjunto de datos referente al a producción de queso azul y gorgonzola en Estados Unidos. En la gráfica de la serie de tiempo podremos observar que es evidentemente no estacionaria por lo que un análisis de sus diferencias es crucial.</p>
<p>Estudiaremos sus diferencias rigurosamente buscando volver estacionaria la serie, para finalmente ajustar un modelo ARIMA en base a la información proporcionada por sus ACF y PACF.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>                                  <span class="do">### PRODUCCIÓN DE QUESO </span><span class="al">###</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="do">### Librerías necesarias </span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nortest) <span class="co"># Anderson-Darling</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast) <span class="co"># Librería necesaria para la función Arima</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tseries) <span class="co"># Prueba Dickey-Fuller para estacionariedad</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>queso <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="dv">7657</span>, <span class="dv">5451</span>, <span class="dv">10883</span>, <span class="dv">9554</span>, <span class="dv">9519</span>, <span class="dv">10047</span>, <span class="dv">10663</span>, <span class="dv">10864</span>, <span class="dv">11447</span>, <span class="dv">12710</span>, </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="dv">15169</span>, <span class="dv">16205</span>, <span class="dv">14507</span>, <span class="dv">15400</span>, <span class="dv">16800</span>, <span class="dv">19000</span>, <span class="dv">20198</span>, <span class="dv">18573</span>, <span class="dv">19375</span>, <span class="dv">21032</span>, </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="dv">23250</span>, <span class="dv">25219</span>, <span class="dv">28549</span>, <span class="dv">29759</span>,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="dv">28262</span>, <span class="dv">28506</span>, <span class="dv">33885</span>, <span class="dv">34776</span>, <span class="dv">35347</span>, <span class="dv">34628</span>, <span class="dv">33043</span>, <span class="dv">30214</span>, <span class="dv">31013</span>, <span class="dv">31496</span>, </span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="dv">34115</span>, <span class="dv">33433</span>, <span class="dv">34198</span>, <span class="dv">35863</span>, <span class="dv">37789</span>, <span class="dv">34561</span>, <span class="dv">36434</span>, <span class="dv">34371</span>, <span class="dv">33307</span>, <span class="dv">33295</span>, </span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="dv">36514</span>, <span class="dv">36593</span>, <span class="dv">38311</span>, <span class="dv">42773</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfica de la serie de tiempo</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>queso_ts <span class="ot">=</span> <span class="fu">ts</span>(queso, <span class="at">start =</span> <span class="dv">1950</span>, <span class="at">frequency =</span> <span class="dv">1</span>) <span class="co"># Guardamos los datos como una serie de tiempo</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(queso_ts, <span class="at">main =</span> <span class="st">"Producción de queso"</span>,</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Año"</span>, <span class="at">ylab =</span> <span class="st">"Producción (miles de libras)"</span>,</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"#F4B4C9"</span>, <span class="at">lwd =</span> <span class="dv">2</span>) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-Ajuste-del-modelo-a-una-serie-de-tiempo_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#points(queso_ts, pch = 16, col = "#CE93D8") # Graficamos los datos con circulos</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="do">########## Revisamos la primer diferencia</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfica de la serie de tiempo</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>queso_diff <span class="ot">=</span> <span class="fu">ts</span>(<span class="fu">diff</span>(queso_ts))</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(queso_diff, <span class="at">main =</span> <span class="st">"Primera diferencia"</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Diferencia"</span>, <span class="at">ylab =</span> <span class="st">"Producción (miles de libras)"</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"#F4B4C9"</span>, <span class="at">lwd =</span> <span class="dv">2</span>) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-Ajuste-del-modelo-a-una-serie-de-tiempo_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#points(queso_diff, pch = 16, col = "#CE93D8") # Graficamos los datos con circulos</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(queso_diff) <span class="co"># Prueba de Dickey-Fuller para estacionariedad.</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  queso_diff
Dickey-Fuller = -2.8641, Lag order = 3, p-value = 0.2297
alternative hypothesis: stationary</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="do">########## Revisamos la segunda diferencia</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfica de la serie de tiempo</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>queso_diff2 <span class="ot">=</span> <span class="fu">ts</span>(<span class="fu">diff</span>(queso_diff))</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(queso_diff2, <span class="at">main =</span> <span class="st">"Segunda diferencia"</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Diferencia"</span>, <span class="at">ylab =</span> <span class="st">"Producción (miles de libras)"</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"#F4B4C9"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-Ajuste-del-modelo-a-una-serie-de-tiempo_files/figure-html/unnamed-chunk-2-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#points(queso_diff2, pch = 16, col = "#CE93D8") # Graficamos los datos con circulos</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(queso_diff2) <span class="co"># Prueba de Dickey-Fuller para estacionariedad.</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  queso_diff2
Dickey-Fuller = -4.2795, Lag order = 3, p-value = 0.01
alternative hypothesis: stationary</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Revisamos ACF y PACF de la segunda diferencia</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(queso_diff2, <span class="at">main =</span> <span class="st">"ACF"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-Ajuste-del-modelo-a-una-serie-de-tiempo_files/figure-html/unnamed-chunk-2-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(queso_diff2, <span class="at">main =</span> <span class="st">"PACF"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-Ajuste-del-modelo-a-una-serie-de-tiempo_files/figure-html/unnamed-chunk-2-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Los correlogramas indican un ARIMA(1,2,1), posiblemente.</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustamos un modelo ARIMA</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>modelo <span class="ot">=</span> <span class="fu">Arima</span>(queso_ts, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>)) <span class="co"># Seleccionamos el modelo arima</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co">#modelo = auto.arima(queso_ts) #Se selecciona el "mejor" arima algorítmicamente.</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Series: queso_ts 
ARIMA(1,2,1) 

Coefficients:
          ar1     ma1
      -0.0542  -1.000
s.e.   0.1577   0.065

sigma^2 = 3848217:  log likelihood = -414.98
AIC=835.96   AICc=836.53   BIC=841.44

Training set error measures:
                   ME     RMSE      MAE       MPE     MAPE      MASE       ACF1
Training set 80.04719 1878.173 1369.098 0.5073474 6.078675 0.8437926 0.03793247</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>residuales <span class="ot">=</span> <span class="fu">as.numeric</span>(modelo<span class="sc">$</span>residuals) <span class="co"># Guardamos residuales.</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>ajustados <span class="ot">=</span> <span class="fu">as.numeric</span>(modelo<span class="sc">$</span>fitted) <span class="co"># Guardamos valores ajustados.</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfica de ajustados vs residuales</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ajustados, residuales, </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Valores ajustados"</span>, </span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Residuales"</span>, </span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Residuales vs Ajustados"</span>,</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">16</span>,  <span class="co"># punto sólido</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"#F4B4C9"</span>)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"#F06292"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-Ajuste-del-modelo-a-una-serie-de-tiempo_files/figure-html/unnamed-chunk-2-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(modelo)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-Ajuste-del-modelo-a-una-serie-de-tiempo_files/figure-html/unnamed-chunk-2-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from ARIMA(1,2,1)
Q* = 5.0046, df = 8, p-value = 0.7571

Model df: 2.   Total lags used: 10</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ad.test</span>(residuales) <span class="co"># Prueba de normalidad para los residuales</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Anderson-Darling normality test

data:  residuales
A = 0.61519, p-value = 0.1034</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(residuales)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(residuales, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-Ajuste-del-modelo-a-una-serie-de-tiempo_files/figure-html/unnamed-chunk-2-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfica de la serie de tiempo</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(queso_ts, <span class="at">main =</span> <span class="st">"Producción de queso"</span>,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Año"</span>, <span class="at">ylab =</span> <span class="st">"Producción (miles de libras)"</span>,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"#F4B4C9"</span>, <span class="at">lwd =</span> <span class="dv">2</span>) </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="co">#points(queso, pch = 16, col = "#F4B4C9") # Graficamos los datos con circulos</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>ajustados_ts <span class="ot">=</span> <span class="fu">ts</span>(ajustados, <span class="at">start =</span> <span class="dv">1950</span>, <span class="at">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Encimamos los valores ajustados.</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(ajustados_ts, <span class="at">col =</span> <span class="st">"#F06292"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="co">#points(ajustados, col = "#CE93D8", lwd = 2, pch = 16)</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Añadir leyenda</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Original"</span>, <span class="st">"Ajustado"</span>),</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"#F4B4C9"</span>, <span class="st">"#F06292"</span>), <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-Ajuste-del-modelo-a-una-serie-de-tiempo_files/figure-html/unnamed-chunk-2-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-abraham83" class="csl-entry" role="listitem">
Abraham, Bovas, y Johannes Ledolter. 1983. <em>Statistical Methods for Forecasting</em>. 1.ª ed. New Jersey: Wiley.
</div>
<div id="ref-cowper09" class="csl-entry" role="listitem">
Cowpertwait, Paul S. P., y Andrew V. Metcalfe. 2009. <em>Introductory Time Series with R</em>. 1.ª ed. Wiley series en probability y mathematical statistics. Applied probability y statistics. Baltimore: Springer.
</div>
<div id="ref-enders15" class="csl-entry" role="listitem">
Enders, Walter. 2015. <em>Applied Econometric Time Series</em>. 1.ª ed. New York: Wiley.
</div>
<div id="ref-hamilton15" class="csl-entry" role="listitem">
Hamilton, J. D. 2020. <em>Times series Analysis</em>. 1.ª ed. Wiley.
</div>
<div id="ref-montgomery08" class="csl-entry" role="listitem">
Montgomery, Douglas C., Cheryl L. Jennings, y Murat Kulahci. 2008. <em>Introduction to Time Series Analysis and Forecasting</em>. 1.ª ed. Wiley series en probability y mathematical statistics. Applied probability y statistics. New York: Wiley.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../Caps/03-Modelos lineales para series de tiempo estacionarias.html" class="pagination-link" aria-label="Modelos lineales para series de tiempo estacionarias">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Modelos lineales para series de tiempo estacionarias</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../Caps/05-Caso de estudio.html" class="pagination-link" aria-label="Casos de Estudios">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Casos de Estudios</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>