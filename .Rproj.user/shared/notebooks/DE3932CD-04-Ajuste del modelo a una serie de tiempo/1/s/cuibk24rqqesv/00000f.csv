"0","#| message: false"
"0","#| warning: false"
"0","#| paged-print: false"
"0","                                  ### PRODUCCI√ìN DE QUESO ###"
"0",""
"0","### Librer√≠as necesarias "
"0","library(nortest) # Anderson-Darling"
"0","library(forecast) # Librer√≠a necesaria para la funci√≥n Arima"
"0","library(tseries) # Prueba Dickey-Fuller para estacionariedad"
"0",""
"0","queso = c("
"0","  7657, 5451, 10883, 9554, 9519, 10047, 10663, 10864, 11447, 12710, "
"0","  15169, 16205, 14507, 15400, 16800, 19000, 20198, 18573, 19375, 21032, "
"0","  23250, 25219, 28549, 29759,"
"0","  28262, 28506, 33885, 34776, 35347, 34628, 33043, 30214, 31013, 31496, "
"0","  34115, 33433, 34198, 35863, 37789, 34561, 36434, 34371, 33307, 33295, "
"0","  36514, 36593, 38311, 42773"
"0",")"
"0",""
"0","# Gr√°fica de la serie de tiempo"
"0","queso_ts = ts(queso, start = 1950, frequency = 1) # Guardamos los datos como una serie de tiempo"
"0","plot(queso_ts, main = ""Producci√≥n de queso"","
"0","     xlab = ""A√±o"", ylab = ""Producci√≥n (miles de libras)"","
"0","     col = ""#F4B4C9"", lwd = 2) "
"2","G1;Error en (function (filename = ""Rplot%03d.png"", width = 480, height = 480, : 
  unable to start png() device
Error durante el wrapup: no hay tantas estructuras en la pila
H1;Errorh: no more error handlers available (recursive errors?); invoking 'abort' restart
g"
"0","#points(queso_ts, pch = 16, col = ""#CE93D8"") # Graficamos los datos con circulos"
"0",""
"0","########## Revisamos la primer diferencia"
"0",""
"0","# Gr√°fica de la serie de tiempo"
"0","queso_diff = ts(diff(queso_ts))"
"0","plot(queso_diff, main = ""Primera diferencia"","
"0","     xlab = ""Diferencia"", ylab = ""Producci√≥n (miles de libras)"","
"0","     col = ""#F4B4C9"", lwd = 2) "
"2","G1;Error en (function (filename = ""Rplot%03d.png"", width = 480, height = 480, : 
  unable to start png() device
Error durante el wrapup: no hay tantas estructuras en la pila
H1;Errorh: no more error handlers available (recursive errors?); invoking 'abort' restart
g"
"0","#points(queso_diff, pch = 16, col = ""#CE93D8"") # Graficamos los datos con circulos"
"0",""
"0",""
"0","adf.test(queso_diff) # Prueba de Dickey-Fuller para estacionariedad."
"1","
	Augmented Dickey-Fuller Test

data:  queso_diff
Dickey-Fuller = -2.8641, Lag order = 3, p-value = 0.2297
alternative hypothesis: stationary

"
"0","########## Revisamos la segunda diferencia"
"0",""
"0","# Gr√°fica de la serie de tiempo"
"0","queso_diff2 = ts(diff(queso_diff))"
"0","plot(queso_diff2, main = ""Segunda diferencia"","
"0","     xlab = ""Diferencia"", ylab = ""Producci√≥n (miles de libras)"","
"0","     col = ""#F4B4C9"", lwd = 2)"
"2","G1;Error en (function (filename = ""Rplot%03d.png"", width = 480, height = 480, : 
  unable to start png() device
Error durante el wrapup: no hay tantas estructuras en la pila
H1;Errorh: no more error handlers available (recursive errors?); invoking 'abort' restart
g"
"0","#points(queso_diff2, pch = 16, col = ""#CE93D8"") # Graficamos los datos con circulos"
"0",""
"0",""
"0","adf.test(queso_diff2) # Prueba de Dickey-Fuller para estacionariedad."
"1","
	Augmented Dickey-Fuller Test

data:  queso_diff2
Dickey-Fuller = -4.2795, Lag order = 3, p-value = 0.01
alternative hypothesis: stationary

"
"0","# Revisamos ACF y PACF de la segunda diferencia"
"0","acf(queso_diff2, main = ""ACF"")"
"2","G1;Error en (function (filename = ""Rplot%03d.png"", width = 480, height = 480, : 
  unable to start png() device
Error durante el wrapup: no hay tantas estructuras en la pila
H1;Errorh: no more error handlers available (recursive errors?); invoking 'abort' restart
g"
"0","pacf(queso_diff2, main = ""PACF"")"
"2","G1;Error en (function (filename = ""Rplot%03d.png"", width = 480, height = 480, : 
  unable to start png() device
Error durante el wrapup: no hay tantas estructuras en la pila
H1;Errorh: no more error handlers available (recursive errors?); invoking 'abort' restart
g"
"0","# Los correlogramas indican un ARIMA(1,2,1), posiblemente."
"0",""
"0","# Ajustamos un modelo ARIMA"
"0",""
"0",""
"0","modelo = Arima(queso_ts, order = c(1,2,1)) # Seleccionamos el modelo arima"
"0","#modelo = auto.arima(queso_ts) #Se selecciona el ""mejor"" arima algor√≠tmicamente."
"0","summary(modelo)"
"1","Series: queso_ts 
ARIMA(1,2,1) 

Coefficients:
          ar1     ma1
      -0.0542  -1.000
s.e.   0.1577   0.065

sigma^2 = 3848217:  log likelihood = -414.98
AIC=835.96   AICc=836.53   BIC=841.44

Training set error measures:
                   ME     RMSE      MAE       MPE     MAPE      MASE       ACF1
Training set 80.04719 1878.173 1369.098 0.5073474 6.078675 0.8437926 0.03793247
"
"0","residuales = as.numeric(modelo$residuals) # Guardamos residuales."
"0","ajustados = as.numeric(modelo$fitted) # Guardamos valores ajustados."
"0",""
"0","# Gr√°fica de ajustados vs residuales"
"0","plot(ajustados, residuales, "
"0","     xlab = ""Valores ajustados"", "
"0","     ylab = ""Residuales"", "
"0","     main = ""Residuales vs Ajustados"","
"0","     pch = 16,  # punto s√≥lido"
"0","     col = ""#F4B4C9"")"
"2","G1;Error en (function (filename = ""Rplot%03d.png"", width = 480, height = 480, : 
  unable to start png() device
Error durante el wrapup: no hay tantas estructuras en la pila
H1;Errorh: no more error handlers available (recursive errors?); invoking 'abort' restart
g"
"0","abline(h = 0, col = ""#F06292"", lty = 2)"
"2","G1;Error en (function (filename = ""Rplot%03d.png"", width = 480, height = 480, : 
  unable to start png() device
Error durante el wrapup: no hay tantas estructuras en la pila
H1;Errorh: no more error handlers available (recursive errors?); invoking 'abort' restart
g"
"0","checkresiduals(modelo)"
"2","G1;Error en (function (filename = ""Rplot%03d.png"", width = 480, height = 480, : 
  unable to start png() device
Error durante el wrapup: no hay tantas estructuras en la pila
H1;Errorh: no more error handlers available (recursive errors?); invoking 'abort' restart
g"
"0","ad.test(residuales) # Prueba de normalidad para los residuales"
"1","
	Anderson-Darling normality test

data:  residuales
A = 0.61519, p-value = 0.1034

"
"0","qqnorm(residuales)"
"2","G1;Error en (function (filename = ""Rplot%03d.png"", width = 480, height = 480, : 
  unable to start png() device
Error durante el wrapup: no hay tantas estructuras en la pila
H1;Errorh: no more error handlers available (recursive errors?); invoking 'abort' restart
g"
"0","qqline(residuales, col = ""red"")"
"2","G1;Error en (function (filename = ""Rplot%03d.png"", width = 480, height = 480, : 
  unable to start png() device
Error durante el wrapup: no hay tantas estructuras en la pila
H1;Errorh: no more error handlers available (recursive errors?); invoking 'abort' restart
g"
"0","# Gr√°fica de la serie de tiempo"
"0","plot(queso_ts, main = ""Producci√≥n de queso"","
"0","     xlab = ""A√±o"", ylab = ""Producci√≥n (miles de libras)"","
"0","     col = ""#F4B4C9"", lwd = 2) "
"2","G1;Error en (function (filename = ""Rplot%03d.png"", width = 480, height = 480, : 
  unable to start png() device
Error durante el wrapup: no hay tantas estructuras en la pila
H1;Errorh: no more error handlers available (recursive errors?); invoking 'abort' restart
g"
"0","#points(queso, pch = 16, col = ""#F4B4C9"") # Graficamos los datos con circulos"
"0",""
"0","ajustados_ts = ts(ajustados, start = 1950, frequency = 1)"
"0",""
"0","# Encimamos los valores ajustados."
"0","lines(ajustados_ts, col = ""#F06292"", lwd = 2)"
"2","G1;Error en (function (filename = ""Rplot%03d.png"", width = 480, height = 480, : 
  unable to start png() device
Error durante el wrapup: no hay tantas estructuras en la pila
H1;Errorh: no more error handlers available (recursive errors?); invoking 'abort' restart
g"
"0","#points(ajustados, col = ""#CE93D8"", lwd = 2, pch = 16)"
"0",""
"0","# A√±adir leyenda"
"0","legend(""topleft"", legend = c(""Original"", ""Ajustado""),"
"0","       col = c(""#F4B4C9"", ""#F06292""), lwd = 2)"
"2","G1;Error en (function (filename = ""Rplot%03d.png"", width = 480, height = 480, : 
  unable to start png() device
Error durante el wrapup: no hay tantas estructuras en la pila
H1;Errorh: no more error handlers available (recursive errors?); invoking 'abort' restart
g"
